{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<h1>Collections Dashboard</h1>

<!-- Collector Notes Section -->
<section>
  <h2>Collector Notes</h2>
  <button id="openModalBtn">Add Note</button>
  <ul>
    {% for note in notes %}
      <li>{{ note[1] }} - Transaction ID: {{ note[2] }} - Payment Plan ID: {{ note[3] }}</li>
    {% else %}
      <li>No notes available.</li>
    {% endfor %}
  </ul>
</section>

<!-- Customer Transactions Section -->
<section>
  <h2>Customer Transactions</h2>
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Customer Name</th>
        <th>Amount</th>
        <th>Transaction Date</th>
        <th>Transaction Time</th>
        <th>Payment Plan</th>
      </tr>
    </thead>
    <tbody>
      {% for transaction in transactions %}
        <tr>
          <td>{{ transaction[0] }}</td>
          <td>{{ transaction[1] }}</td>
          <td>${{ transaction[2] }}</td>
          <td>{{ transaction[3] }}</td>
          <td>{{ transaction[4] }}</td>
          <td>{{ transaction[5] }}</td> <!-- Payment Plan -->
        </tr>
      {% else %}
        <tr>
          <td colspan="6">No transactions available.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</section>

<!-- Payment Plans Section -->
<section>
  <h2>Payment Plans</h2>
  <table>
    <thead>
      <tr>
        <th>Plan Name</th>
        <th>Duration</th>
        <th>Price</th>
        <th>Start Date</th>
        <th>End Date</th>
      </tr>
    </thead>
    <tbody>
      {% for plan in payment_plans %}
        <tr>
          <td>{{ plan[1] }}</td>
          <td>{{ plan[2] }} months</td>
          <td>${{ plan[3] }}</td>
          <td>{{ plan[4] }}</td>
          <td>{{ plan[5] }}</td>
        </tr>
      {% else %}
        <tr>
          <td colspan="5">No payment plans available.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</section>

<!-- Modal for Adding a Note -->
<div id="noteModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Add a Note</h2>
    <form method="POST" action="{{ url_for('add_note') }}">
      <textarea name="note" placeholder="Enter note details..."></textarea>
      
      <!-- Create a New Transaction -->
      <h3>New Transaction</h3>
      <input type="text" name="customer_name" placeholder="Customer Name" required>
      <input type="number" name="amount" step="0.01" placeholder="Amount" required>
      <input type="date" name="transaction_date" required>
      <input type="time" name="transaction_time" required>

      <!-- Create or Choose an Existing Payment Plan -->
      <h3>Payment Plan</h3>
      <select name="payment_plan_id">
          <option value="1">Basic Plan</option>
          <option value="2">Premium Plan</option>
          <option value="3">Standard Plan</option> <!-- Add Standard Plan -->
      </select>
      <button type="submit">Add Note, Transaction & Payment Plan</button>
    </form>
  </div>
</div>

{% endblock %}


